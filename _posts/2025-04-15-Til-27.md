---
title: "[TIL] DAY41 HttpMessageConverter, ArgumentResolver, ReturnValueHandler"
categories: [ë‚´ì¼ë°°ì›€ìº í”„, TIL]
tag: [ê°œì¸ ê³¼ì œ, ë³¸ìº í”„, Spring MVC, HttpMessageConverter, ArgumentResolver, ReturnValueHandler]
date: 2025-04-15 21:10:00 +0900
toc_sticky: true
---
## ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ
***
### Spring HttpMessageConverter
Springì—ì„œ `HttpMessageConverter`ëŠ” REST APIë¥¼ ë‹¤ë£° ë•Œ í•µì‹¬ì ì¸ ì—­í• ì„ í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ Viewë¥¼ ì‘ë‹µí•˜ëŠ” ëŒ€ì‹  JSON, XML, TEXT ë“± ë°ì´í„°ë¥¼ HTTP ë©”ì‹œì§€ì˜ bodyì— ì§ì ‘ ì…ë ¥í•˜ì—¬ ë°˜í™˜í•  ë•Œ ì‚¬ìš©ëœë‹¤.

***
#### ğŸ“Œ HttpMessageConverterë€?
- `@RestController` ë˜ëŠ” `@ResponseBody`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì§ì ‘ ì‘ë‹µí•  ë•Œ ë™ì‘í•˜ëŠ” ì»¨ë²„í„°
- í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì˜ `Content-Type`ê³¼ `Accept` í—¤ë”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•  ì»¨ë²„í„°ë¥¼ ìë™ ì„ íƒ
- ViewResolverê°€ ì•„ë‹Œ `HttpMessageConverter`ê°€ ë™ì‘í•¨

> ğŸ’¡ `@RestController` = `@Controller` + `@ResponseBody`

***
#### âœ… SSR vs CSR

| êµ¬ë¶„ | ì„¤ëª… |
|------|------|
| SSR (Server Side Rendering) | `@Controller` + View Template - ì„œë²„ì—ì„œ HTMLì„ ì§ì ‘ ë Œë”ë§ |
| CSR (Client Side Rendering) | `@RestController` + Data - í´ë¼ì´ì–¸íŠ¸ê°€ ë°ì´í„°ë¥¼ ë°›ì•„ì„œ í™”ë©´ êµ¬ì„± |

> ì‹¤ì œë¡œëŠ” SSRê³¼ CSRì´ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ê°€ ë§ìŒ

***
#### âš™ï¸ HttpMessageConverter ë™ì‘ ì›ë¦¬
**ìš”ì²­ ì²˜ë¦¬(Request)**
1. ìš”ì²­ í—¤ë”ì˜ `Content-Type` í™•ì¸
2. `@RequestBody`, `HttpEntity<>`, `RequestEntity<>`ë¡œ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
3. ë“±ë¡ëœ ì»¨ë²„í„°ë“¤ì˜ `canRead()` ë©”ì„œë“œë¥¼ í†µí•´ ì²˜ë¦¬ ê°€ëŠ¥í•œ ì»¨ë²„í„° íƒìƒ‰
4. `read()` ë©”ì„œë“œë¡œ ê°ì²´ ë³€í™˜

```java
T read(Class<? extends T> clazz, HttpInputMessage inputMessage);
```
***
**ì‘ë‹µ ì²˜ë¦¬(Response)**
1. `@ResponseBody`, `HttpEntity<>`, `ResponseEntity<>`ë¡œ ë°ì´í„° ë°˜í™˜
2. `canWrite()` ë©”ì„œë“œë¡œ ê°€ëŠ¥í•œ ì»¨ë²„í„° íƒìƒ‰
3. `write()` ë©”ì„œë“œë¡œ ì‘ë‹µ ë©”ì‹œì§€ bodyì— ë°ì´í„° ì…ë ¥

```java
void write(T t, MediaType contentType, HttpOutputMessage outputMessage);
```

***
#### ğŸ”„ ì£¼ìš” HttpMessageConverter ì¢…ë¥˜

| ì»¨ë²„í„°                          | ëŒ€ìƒ              | Content-Type     | ë°˜í™˜                       |
|-------------------------------|-------------------|------------------|----------------------------|
| ByteArrayHttpMessageConverter | `byte[]`          | `*/*`            | `application/octet-stream` |
| StringHttpMessageConverter    | `String`          | `*/*`            | `text/plain`               |
| MappingJackson2HttpMessageConverter | `Object`, `Map` | `application/json` | `application/json`        |

### ArgumentResolver
Spring MVCëŠ” ìš°ë¦¬ê°€ í”íˆ ì‚¬ìš©í•˜ëŠ” `@GetMapping`, `@PostMapping` ë“±ìœ¼ë¡œ ì›¹ ìš”ì²­ì„ ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ”ë°, ê·¸ ë‚´ë¶€ì—ì„œëŠ” ì•„ì£¼ ì •êµí•œ êµ¬ì¡°ë¡œ ìš”ì²­ê³¼ ì‘ë‹µì„ ì²˜ë¦¬í•˜ê³  ìˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œëŠ” `RequestMappingHandlerAdapter`, `ArgumentResolver`, `ReturnValueHandler` ë“±ì´ ìˆë‹¤.

***
#### ğŸ“Œ RequestMappingHandlerAdapterë€?
- Spring MVCì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ HTTP ìš”ì²­ì„ ì ì ˆí•œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì™€ ì—°ê²°í•˜ê³  ì‹¤í–‰í•œ ë’¤ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸

##### ğŸ”§ Spring MVC êµ¬ì¡°
![image](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Ff8018abf-3fb1-4358-b4dc-b5b72eab2153%2FUntitled.png?table=block&id=13b2dc3e-f514-8145-834e-e038c0647ef2&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=860&userId=&cache=v2)
- í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì€ `DispatcherServlet`ì„ ê±°ì³ `HandlerMapping`ì„ í†µí•´ ì•Œë§ì€ `Controller`ë¡œ ì „ë‹¬ë¨
- ê·¸ ì¤‘ê°„ì—ì„œ `HandlerAdapter`(ëŒ€í‘œì ìœ¼ë¡œ `RequestMappingHandlerAdapter`)ê°€ `ArgumentResolver`ë¥¼ í†µí•´ íŒŒë¼ë¯¸í„°ë¥¼ ì¤€ë¹„í•˜ê³ , `ReturnValueHandler`ë¥¼ í†µí•´ ì‘ë‹µê°’ì„ ë³€í™˜í•¨

***
#### âœ… ArgumentResolverë€?
- `ArgumentResolver`ëŠ” **Controller ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ì— ê°’ì„ ë°”ì¸ë”©**í•´ì£¼ëŠ” ì—­í• ì„ í•¨
- `@RequestBody`ë‚˜ `@RequestParam`ì´ ë¶™ì€ íŒŒë¼ë¯¸í„°ë“¤ì€ ëª¨ë‘ ArgumentResolverê°€ ì²˜ë¦¬í•¨

```java
@PostMapping("/hello")
public String hello(@RequestBody UserDto userDto, @RequestParam String name) {
  ...
}
```

##### ğŸ“ ì™œ ì¤‘ìš”í•œê°€?
- ë‹¤ì–‘í•œ ì• ë…¸í…Œì´ì…˜ ê¸°ë°œ íŒŒë¼ë¯¸í„°ë“¤ì„ ìë™ìœ¼ë¡œ ë³€í™˜í•´ì¤Œ
- ì§ì ‘ **ì»¤ìŠ¤í…€ ArgumentResolver**ë¥¼ êµ¬í˜„í•˜ì—¬ í™•ì¥í•  ìˆ˜ë„ ìˆìŒ

##### âš™ï¸ HandlerMethodArgumentResolver
Springì´ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” `ArgumentResolver`ì˜ ì‹¤ì œ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„

```java
public interface HandlerMethodArgumentResolver {
    boolean supportsParameter(MethodParameter parameter);
    Object resolveArgument(MethodParameter parameter, ...);
}
```

âœ… ë™ì‘ ê³¼ì •
1. `supportsParameter()`ë¥¼ í†µí•´ í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸
2. ì§€ì›í•œë‹¤ë©´ `resolveArgument()`ë¥¼ í†µí•´ ê°ì²´ë¥¼ ìƒì„±
3. ìƒì„±ëœ ê°ì²´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë©”ì„œë“œ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë¨

##### ğŸŒŸ ê¸°ë³¸ ì œê³µ ArgumentResolver ì˜ˆì‹œ

| ì• ë…¸í…Œì´ì…˜         | Resolver í´ë˜ìŠ¤                            |
|------------------|--------------------------------------------|
| `@RequestBody`   | `RequestResponseBodyMethodProcessor`       |
| `@RequestHeader` | `RequestHeaderMethodArgumentResolver`      |
| `@ModelAttribute`| `ModelAttributeMethodProcessor`            |

***
#### ğŸ“¨ ReturnValueHandlerë€?
- ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°˜í™˜í•œ ê°’ì„ HTTP ì‘ë‹µì— ë§ê²Œ ë³€í™˜í•˜ëŠ” ì—­í• 
- ë©”ì„œë“œê°€ ëë‚œ **í›„ì²˜ë¦¬**ë¥¼ ë‹´ë‹¹

```java
@GetMapping("/hi")
public ResponseEntity<String> hi() {
    return ResponseEntity.ok("Hello!");
}
```

##### âš™ï¸ HandlerMethodReturnValueHandler
- Springì´ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” `ReturnValueHandler`ì˜ ì‹¤ì œ ì¸í„°í˜ì´ìŠ¤

```java
public interface HandlerMethodReturnValueHandler {
    boolean supportsReturnType(MethodParameter returnType);
    void handleReturnValue(Object returnValue, ...);
}
```

##### ğŸŒŸ ê¸°ë³¸ ì œê³µ ReturnValueHandler ì˜ˆì‹œ

| ë°˜í™˜ íƒ€ì…         | Handler í´ë˜ìŠ¤                           |
|------------------|------------------------------------------|
| `ModelAndView`   | `ModelAndViewMethodReturnValueHandler`   |
| `HttpEntity`     | `HttpEntityMethodProcessor`              |
| `@ResponseBody`  | `RequestResponseBodyMethodProcessor`     |

***

### HttpMessageConverter(2)
#### ğŸ’¡ HttpMessageConverterë€?
`HttpMessageConverter`ëŠ” Spring MVCì—ì„œ HTTP ìš”ì²­/ì‘ë‹µ ë°”ë””ë¥¼ ê°ì²´ë¡œ ë³€í™˜í•˜ê±°ë‚˜ ê°ì²´ë¥¼ ë‹¤ì‹œ ë°”ë””ë¡œ ë³€í™˜í•´ì£¼ëŠ” í•µì‹¬ ì»¨í¬ë„ŒíŠ¸ë‹¤.
- `@RequestBody`
- `@ResponseBody`

***
#### ğŸ“Œ HttpMessageConverterëŠ” ì–´ë””ì—ì„œ ë™ì‘í• ê¹Œ?
##### âœ… RequestMappingHandlerAdapter êµ¬ì¡°
![image](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F3aa238be-3a34-4098-9fb8-68874cd4e041%2FUntitled.png?table=block&id=13b2dc3e-f514-81c8-93ed-c37d4bb7e776&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=860&userId=&cache=v2)
- `RequestMappingHandlerAdapter`ëŠ” ìŠ¤í”„ë§ MVCì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ìš”ì²­ê³¼ ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ì‹¬ ì»´í¬ë„ŒíŠ¸
- ì´ ì•ˆì—ì„œ `HttpMessageConverter`ê°€ ë™ì‘í•¨

***
#### âš™ï¸ HttpMessageConverterê°€ ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ìœ„ì¹˜
![image](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fa51489f5-551e-49cb-8938-27c65c938936%2FUntitled.png?table=block&id=13b2dc3e-f514-8191-9cb1-d1390c3f7e47&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=860&userId=&cache=v2)
- ìš”ì²­ ì‹œ â†’ `ArgumentResolver`ì—ì„œ ì‚¬ìš©
- ì‘ë‹µ ì‹œ â†’ `ReturnValueHandler`ì—ì„œ ì‚¬ìš©

***
#### ğŸ“ ì£¼ìš” êµ¬í˜„ì²´
##### ğŸ“ `RequestResponseBodyMethodProcessor`
- `@RequestBody`ì™€ `@ResponseBody`ë¥¼ ì²˜ë¦¬í•¨

**í´ë˜ìŠ¤ êµ¬ì¡°**
![image](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F81fdbc14-9f2f-49cd-936d-185f668ff150%2FUntitled.png?table=block&id=13b2dc3e-f514-81b5-8619-d7ee35427b21&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=860&userId=&cache=v2)
- `HandlerMethodArgumentResolver`ì™€ `HandlerMethodReturnValueHandler`ë¥¼ ëª¨ë‘ ìƒì† â†’ ìš”ì²­ê³¼ ì‘ë‹µì„ ëª¨ë‘ ì²˜ë¦¬í•´ì•¼ í•˜ê¸° ë•Œë¬¸

***
##### ğŸ“ `HttpEntityMethodProcessor`
- `HttpEntity<>`, `RequestEntity<>`, `ResponseEntity<>`ë¥¼ ì²˜ë¦¬

**í´ë˜ìŠ¤ êµ¬ì¡°**
![image](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F96c8504f-47cd-4f3d-85e8-c3f95965e774%2FUntitled.png?table=block&id=13b2dc3e-f514-8118-8c05-c848ad060168&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=860&userId=&cache=v2)

**ì£¼ìš” ë©”ì„œë“œ**
- `supportParameter()`
  - íŒŒë¼ë¯¸í„°ê°€ `HttpEntity` í˜¹ì€ ê·¸ í•˜ìœ„ íƒ€ì…ì¸ì§€ í™•ì¸
- `resolveArgument()`
  - ì‹¤ì œ Objectë¡œ ë³€í™˜

#### ğŸ”„ ìš”ì²­ê³¼ ì‘ë‹µ ì²˜ë¦¬ íë¦„
##### ìš”ì²­ ì²˜ë¦¬ íë¦„
- `@RequestBody` â†’ `RequestResponseBodyMethodProcessor` â†’ `HttpMessageConverter`
- `HttpEntity` â†’ `HttpEntityMethodProcessor` â†’ `HttpMessageConverter`

##### ì‘ë‹µ ì²˜ë¦¬ íë¦„
- `@ResponseBody` â†’ `RequestResponseBodyMethodProcessor` â†’ `HttpMessageConverter`
- `ResponseEntity` â†’ `HttpEntityMethodProcessor` â†’ `HttpMessageConverter`

> ì¦‰, `ArgumentResolver`ì™€ `ReturnValueHanlder`ëŠ” `HttpMessageConverterë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©

***
#### ğŸ”§ WebMvcConfigurerë¡œ ê¸°ëŠ¥ í™•ì¥
`WebMvcConfigurer`ëŠ” Spring MVCë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì„ í™•ì¥í•  ìˆ˜ ìˆìŒ
- `addArgumentResolvers()`
- `addReturnValueHandlers()`
- `extendMessageConverters()`

```java
@Configuration
public class MyWebConfig implements WebMvcConfigurer {

    @Override
    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {
        // ì»¤ìŠ¤í…€ ì»¨ë²„í„° ì¶”ê°€
    }

    @Override
    public void addArgumentResolvers(List<HandlerMethodArgumentResolver> resolvers) {
        // ì»¤ìŠ¤í…€ ArgumentResolver ì¶”ê°€
    }

    @Override
    public void addReturnValueHandlers(List<HandlerMethodReturnValueHandler> handlers) {
        // ì»¤ìŠ¤í…€ ReturnValueHandler ì¶”ê°€
    }
}
```
