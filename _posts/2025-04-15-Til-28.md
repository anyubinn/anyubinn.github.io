---
title: "[TIL] DAY41 Converter, Formatter"
categories: [ë‚´ì¼ë°°ì›€ìº í”„, TIL]
tag: [ê°œì¸ ê³¼ì œ, ë³¸ìº í”„, Spring MVC, TypeConverter, Converter, Formatter, Spring Formatter]
date: 2025-04-15 21:10:00 +0900
toc_sticky: true
---
## ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ
***
### TypeConverter
#### ğŸ§¬ TypeConverterë€?
- Springì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ íƒ€ì… ë³€í™˜í•´ì£¼ëŠ” ê¸°ëŠ¥
- ex) ë¬¸ìì—´ â†’ ìˆ«ì, ë¬¸ìì—´ â†’ ê°ì²´ ë“±

#### ğŸ§ª ê¸°ë³¸ ì˜ˆì‹œ
##### ğŸ“ ìˆ˜ë™ íƒ€ì… ë³€í™˜

```java
@GetMapping("/param")
public void param(HttpServletRequest request) {
    String stringExample = request.getParameter("example");
    Integer integerExample = Integer.valueOf(stringExample);
}
```

##### ğŸ“ Spring ìë™ ë³€í™˜(`@RequestParam`)

```java
@GetMapping("/v2/param")
public void paramV2(@RequestParam Integer example) {
    log.info("example = {}", example);
}
```
- Springì€ ë‚´ë¶€ì ìœ¼ë¡œ ë¬¸ìì—´ì„ `Integer`ë¡œ ë³€í™˜í•´ì¤Œ
- ì´ ì™¸ì—ë„ `@PathVariable`, `@ModelAttribute`ì—ë„ ì ìš©ë¨

***
#### ğŸ”§ ì‚¬ìš©ì ì •ì˜ Converter
##### ğŸ’¡ Converter Interface
- Springì´ ì œê³µí•˜ëŠ” íƒ€ì… ë°˜í™˜ ì¸í„°í˜ì´ìŠ¤

```java
public interface Converter<S, T> {
    T convert(S source);
}
```

**ë“±ë¡ ë°©ë²•**
- Spring Bootì—ì„œëŠ” `@Component`ë¡œ ë“±ë¡í•˜ë©´ ìë™ìœ¼ë¡œ ì‚¬ìš©ë¨

***
### Converter
#### ğŸ”„ Converterë€?
- ì„œë¡œ ë‹¤ë¥¸ **ë°ì´í„° íƒ€ì… ê°„ì˜ ë³€í™˜**ì„ ì²˜ë¦¬í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜
- ì›¹ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ Java ê°ì²´ë¡œ ë³€í™˜í•˜ê±°ë‚˜ ê·¸ ë°˜ëŒ€ì˜ ê²½ìš°ì— ì£¼ë¡œ ì‚¬ìš©í•¨

##### ğŸ“Œ ì‚¬ìš© ëª©ì 
- ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜
- ë¬¸ìì—´ì„ ì‚¬ìš©ì ì •ì˜ ê°ì²´ë¡œ ë³€í™˜
- ê°ì²´ë¥¼ ë‹¤ì‹œ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ë³€í™˜ ì‘ì—…ì— ì‚¬ìš©

> âœ… Springì€ ë‹¤ì–‘í•œ ê¸°ë³¸ ë³€í™˜ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ë§Œ, ì§ì ‘ êµ¬í˜„í•´ì„œ í™•ì¥ë„ ê°€ëŠ¥

***
#### âš ï¸ ì£¼ì˜ì‚¬í•­
- Springì—ì„œ ì œê³µí•˜ëŠ” `Converter` ì¸í„°í˜ì´ìŠ¤ëŠ” ë‹¤ìŒ íŒ¨í‚¤ì§€ì— ìˆìŒ

```java
org.springframework.core.convert.converter.Converter
```

- ë™ì¼í•œ ì´ë¦„ì„ ê°€ì§„ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë“¤ê³¼ í˜¼ë™í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•¨

***
#### âœï¸ Converter êµ¬í˜„ ì˜ˆì‹œ
##### ğŸ“ `String` â†’ `Integer`

```java
@Slf4j
public class StringToIntegerConverter implements Converter<String, Integer> {
    @Override
    public Integer convert(String source) {
        log.info("source = {}", source);
        return Integer.valueOf(source);
    }
}
```

##### ğŸ“ `Integer` â†’ `String`

```java
@Slf4j
public class IntegerToStringConverter implements Converter<Integer, String> {
    @Override
    public String convert(Integer source) {
        log.info("source = {}", source);
        return String.valueOf(source);
    }
}
```

***
#### ğŸ§ ì‚¬ìš©ì ì •ì˜ ê°ì²´ ë³€í™˜ ì˜ˆì‹œ
##### ğŸ¯ `String` â†’ `Person`

```java
public class StringToPersonConverter implements Converter<String, Person> {
    @Override
    public Person convert(String source) {
        String[] parts = source.split(":");  // "wonuk:1200"
        String name = parts[0];
        int months = Integer.parseInt(parts[1]);
        int age = months / 12;
        return new Person(name, age);
    }
}
```

##### ğŸ¯ `Person` â†’ `String`

```java
public class PersonToStringConverter implements Converter<Person, String> {
    @Override
    public String convert(Person source) {
        String name = source.getName();
        int months = source.getAge() * 12;
        return name + ":" + months;  // "wonuk:1200"
    }
}
```

***
#### ğŸ› ï¸ Converter ì§ì ‘ ì‚¬ìš© ì˜ˆì‹œ

```java
PersonToStringConverter converter = new PersonToStringConverter();
String source = "wonuk:1200";
converter.convert(source);
```

- ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ëª¨ë“ˆí™” ìˆ˜ì¤€ì—ì„œëŠ” ìœ ìš©í•¨
- ì‹¤ì œ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” **ë“±ë¡ í›„ ìë™ ì ìš©ë˜ëŠ” ë°©ì‹ì´ íš¨ìœ¨ì **

***
#### ğŸ“¦ Springì˜ ë‹¤ì–‘í•œ Converter
- Springì€ ë‹¤ì–‘í•œ ë³€í™˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ Converter ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•¨

| ì¸í„°í˜ì´ìŠ¤                 | ì„¤ëª…                                                                 |
|---------------------------|----------------------------------------------------------------------|
| `Converter`               | ê°€ì¥ ê¸°ë³¸ì ì¸ í˜•íƒœ, ë‹¨ì¼ íƒ€ì… ê°„ ë³€í™˜                                |
| `ConverterFactory`        | ë‹¤ì–‘í•œ í•˜ìœ„ íƒ€ì…ì„ ê³ ë ¤í•œ ë³€í™˜ì„ ì§€ì› (ex. `Enum` ë“±)               |
| `GenericConverter`        | ë³µì¡í•˜ê±°ë‚˜ ë‹¤ì–‘í•œ íƒ€ì…ì„ ìœ ì—°í•˜ê²Œ ë³€í™˜ ê°€ëŠ¥                         |
| `ConditionalGenericConverter` | ì¡°ê±´ì— ë”°ë¼ ë³€í™˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ (`matches()` ë©”ì„œë“œë¡œ ì¡°ê±´ íŒë‹¨) |

***
### ConversionService
#### ğŸ” ConversionServiceë€?
- Springì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥
- ì—¬ëŸ¬ `Converter`ë“¤ì„ ë“±ë¡í•˜ê³  ì¼ê´„ì ìœ¼ë¡œ ê´€ë¦¬ ë° ì‚¬ìš©í•˜ë„ë¡ í•¨

##### ğŸ“Œ ì—­í• 
- ë‹¤ì–‘í•œ íƒ€ì… ë³€í™˜ê¸°ë¥¼ **ë“±ë¡ ë° ê´€ë¦¬**í•  ìˆ˜ ìˆìŒ
- ë³€í™˜ ëŒ€ìƒ íƒ€ì…ì— ë§ëŠ” ì»¨ë²„í„°ë¥¼ ì°¾ì•„ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰
- ë³µì¡í•œ ì»¨ë²„í„° ì§ì ‘ ê´€ë¦¬ì—ì„œ í•´ë°© â†’ **ìœ ì§€ë³´ìˆ˜ì„±ê³¼ ì¬ì‚¬ìš©ì„± í–¥ìƒ**

***
#### ğŸ§© ConversionService ì¸í„°í˜ì´ìŠ¤
- Springì—ì„œ ì œê³µí•˜ëŠ” í•µì‹¬ ì¸í„°í˜ì´ìŠ¤
- ë³€í™˜ ê¸°ëŠ¥ì„ ë‹´ë‹¹

| ë©”ì„œë“œ                                              | ì„¤ëª…                     |
|----------------------------------------------------|--------------------------|
| `canConvert(Class<?> sourceType, Class<?> targetType)` | ë³€í™˜ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸       |
| `convert(Object source, Class<T> targetType)`          | ì‹¤ì œ ë³€í™˜ ìˆ˜í–‰            |

***
#### âš™ï¸ DefaultConversionService
`ConversionService`ì˜ ê¸°ë³¸ êµ¬í˜„ì²´ë¡œ Springì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µë¨
- ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ì–‘í•œ ê¸°ë³¸ `Converter`ê°€ ë“±ë¡ë˜ì–´ ìˆìŒ
- `addConverter()` ë©”ì„œë“œë¥¼ í†µí•´ ì»¤ìŠ¤í…€ ì»¨ë²„í„°ë„ ì¶”ê°€í•  ìˆ˜ ìˆìŒ

##### ğŸ’¡ ë™ì‘ êµ¬ì¡° ìš”ì•½
- ë‚´ë¶€ì ìœ¼ë¡œ `ConverterRegistry`ë¥¼ êµ¬í˜„í•˜ì—¬ ì»¨ë²„í„°ë¥¼ ë“±ë¡í•˜ê³  ê´€ë¦¬
- ì™¸ë¶€ì—ì„œëŠ” `ConversionService`ë§Œ ì‚¬ìš©í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìŒ (ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬)

***
#### ğŸ§ª ì½”ë“œ ì˜ˆì‹œ

```java
import static org.assertj.core.api.Assertions.*;
import org.junit.jupiter.api.Test;
import org.springframework.core.convert.support.DefaultConversionService;

public class ConversionServiceTest {

    @Test
    void defaultConversionService() {
        // given
        DefaultConversionService conversionService = new DefaultConversionService();
        conversionService.addConverter(new StringToPersonConverter());
        
        String source = "wonuk:1200";
        Person expected = new Person("wonuk", 100);

        // when
        Person result = conversionService.convert(source, Person.class);

        // then
        assertThat(result.getName()).isEqualTo(expected.getName());
        assertThat(result.getAge()).isEqualTo(expected.getAge());
    }
}
```

##### âœ… ì •ë¦¬
- `convert()`ë§Œ í˜¸ì¶œí•˜ë©´ ì ì ˆí•œ `Converter`ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ ì‹¤í–‰
- í´ë¼ì´ì–¸íŠ¸ëŠ” ë‚´ë¶€ì—ì„œ ì–´ë–¤ ì»¨ë²„í„°ê°€ ì‚¬ìš©ë˜ëŠ”ì§€ ëª°ë¼ë„ ë¨
- ì‚¬ìš©ìëŠ” ë‹¨ìˆœíˆ ì›í•˜ëŠ” íƒ€ì…ìœ¼ë¡œ ë³€í™˜ë§Œ ìš”ì²­í•˜ë©´ ë¨

***
#### ğŸ§± ConverterRegistry
`Converter`ë¥¼ ë“±ë¡í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
- `addConverter()` ë“±ì„ í†µí•´ ë³€í™˜ê¸°ë¥¼ ì¶”ê°€ ê°€ëŠ¥
- ë‚´ë¶€ì ìœ¼ë¡œ `DefaultConversionService`ê°€ ì´ë¥¼ êµ¬í˜„í•˜ê³  ìˆìŒ

> `DefaultConversionService`ëŠ” **ë“±ë¡ê³¼ ì‚¬ìš©ì„ ë™ì‹œì— ì§€ì›í•˜ëŠ” êµ¬í˜„ì²´**

***
#### ğŸ”„ ISP - ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™

> Interface Segregation Principle: "í´ë¼ì´ì–¸íŠ¸ëŠ” ìì‹ ì´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë©”ì„œë“œì— ì˜ì¡´í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤."

Springì€ `ConverterRegistry`ì™€ `ConversionService`ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì´ ì›ì¹™ì„ ì˜ ì§€í‚¤ê³  ìˆìŒ
- ë³€í™˜ ê¸°ëŠ¥ë§Œ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìëŠ” ë“±ë¡ ê¸°ëŠ¥ì„ ëª°ë¼ë„ ë¨
- ë“±ë¡ ë¡œì§ì´ ë³€ê²½ë˜ì–´ë„ ë³€í™˜ ë¡œì§ê³¼ ë¬´ê´€

> ğŸ§µ Springì€ ë‚´ë¶€ì ìœ¼ë¡œë„ `ConversionService`ë¥¼ ì ê·¹ í™œìš©í•˜ê³  ìˆìŒ<br>
> `@RequestParam`, `@PathVariable`, `@ModelAttribute`

***
### Formatter
#### âœ¨ Formatterë€?
- ë¬¸ìì—´ì„ ê°ì²´ë¡œ, ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜í•  ë•Œ íŠ¹ì • í¬ë§·ì„ ì ìš©í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥
- ê¸°ë³¸ì ì¸ íƒ€ì… ë³€í™˜ì€ `Converter`ë¡œ ì¶©ë¶„í•˜ì§€ë§Œ, í˜•ì‹ì„ ì§€ì •í•œ ë³€í™˜ì´ í•„ìš”í•œ ê²½ìš° `Formatter`ë¥¼ ì‚¬ìš©

***
#### ğŸ§­ Formatter vs Converter

| í•­ëª©         | Converter                         | Formatter                              |
|--------------|-----------------------------------|-----------------------------------------|
| ëª©ì          | ë‹¨ìˆœ íƒ€ì… ë³€í™˜                    | í˜•ì‹ì„ ì§€ì •í•œ ë¬¸ìì—´ â†” ê°ì²´ ë³€í™˜        |
| ëŒ€ìƒ         | ëª¨ë“  íƒ€ì…                         | ì£¼ë¡œ ë¬¸ìì—´ ê¸°ë°˜ ë³€í™˜                   |
| í¬ë§· ì§€ì •    | ë¶ˆê°€ëŠ¥                            | ê°€ëŠ¥                                    |
| êµ­ì œí™”       | ë¯¸ì§€ì›                            | `Locale`ì„ í†µí•´ ì§€ì›                    |

***
#### ğŸŒ Localì´ë€?
`ì–¸ì–´ ë° ì§€ì—­ ì •ë³´ë¥¼ ë‹´ì€ ê°ì²´`ë¡œ Formatterì—ì„œ êµ­ì œí™” ì²˜ë¦¬ë¥¼ ìœ„í•´ ì‚¬ìš©ë¨
- ì–¸ì–´ ì½”ë“œ: `en`, `ko`
- êµ­ê°€ ì½”ë“œ: `US`, `KR`

êµ­ì œí™” ì²˜ë¦¬ë¥¼ ìœ„í•´ Formatterê°€ `Local`ì„ ë°›ì•„ í¬ë§·ì„ ì¡°ì •í•  ìˆ˜ ìˆë„ë¡ í•¨

***
#### ğŸ§± Formatter ì¸í„°í˜ì´ìŠ¤ êµ¬ì¡°
`Printer<T>`ì™€ `Parser<T>`ë¥¼ ìƒì†í•œ ì¸í„°í˜ì´ìŠ¤

| ì¸í„°í˜ì´ìŠ¤    | ì—­í•                               |
|----------------|-----------------------------------|
| `Printer<T>`   | ê°ì²´ â†’ ë¬¸ìì—´ (ì¶œë ¥ ì‹œ ì‚¬ìš©)      |
| `Parser<T>`    | ë¬¸ìì—´ â†’ ê°ì²´ (ì…ë ¥ ì‹œ ì‚¬ìš©)      |

***
#### ğŸ› ï¸ Formatter êµ¬í˜„ ì˜ˆì œ

```java
@Slf4j
public class PriceFormatter implements Formatter<Number> {

    @Override
    public Number parse(String text, Locale locale) throws ParseException {
        log.info("text = {}, locale={}", text, locale);

        NumberFormat format = NumberFormat.getInstance(locale);
        return format.parse(text); // "10,000" â†’ 10000L
    }

    @Override
    public String print(Number object, Locale locale) {
        log.info("object = {}, locale = {}", object, locale);

        return NumberFormat.getInstance(locale).format(object); // 10000L â†’ "10,000"
    }
}
```
 > â˜ï¸ `Number`ëŠ” `Integer`, `Long`, `Double`ì˜ ë¶€ëª¨ íƒ€ì…ì´ë¯€ë¡œ ë‹¤ì–‘í•œ ìˆ«ì íƒ€ì…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ

***
### Spring Formatter
#### ğŸ”„ FormattinConversionService
- `ConversionService`ì™€ `Formatter`ë¥¼ ê²°í•©í•œ êµ¬í˜„ì²´
- ë‹¤ì–‘í•œ íƒ€ì… ë³€í™˜ ë° í¬ë§·íŒ…ì„ í•˜ë‚˜ì˜ ì„œë¹„ìŠ¤ë¡œ ê´€ë¦¬
- Springì—ì„œ ë‚´ë¶€ì ìœ¼ë¡œë„ ì‚¬ìš©

##### âœ” ì˜ˆì œ

```java
public class FormattingConversionServiceTest {

    @Test
    void formattingConversionService() {
        DefaultFormattingConversionService conversionService = new DefaultFormattingConversionService();

        // Converter ë“±ë¡
        conversionService.addConverter(new StringToPersonConverter());
        conversionService.addConverter(new PersonToStringConverter());

        // Formatter ë“±ë¡
        conversionService.addFormatter(new PriceFormatter());

        // ì‚¬ìš©
        String result = conversionService.convert(10000, String.class);
        Assertions.assertThat(result).isEqualTo("10,000");
    }
}
```

##### âœ” Spring Boot
- `WebCinversionService`ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ì´ëŠ” `DefaultFormattingConversionService`ë¥¼ ìƒì†í•¨

***
#### ğŸ’¡ Annotation ê¸°ë°˜ Formatter
- `@NumberFormat(pattern = "#,###.##")`
- `@DateTimeFormat(pattern = "dd-MM-yyyy")`

***
#### ğŸ§ª JSON í¬ë§·ê³¼ì˜ ê´€ê³„
##### âš ï¸ `@NumberFormat`, `@DateTimeFormat`ì€ JSONì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ
- ì´ ì–´ë…¸í…Œì´ì…˜ë“¤ì€ `ConversionService` ê¸°ë°˜
- `í¼ ë°ì´í„°`, `URL íŒŒë¼ë¯¸í„°`ì—ëŠ” ì ìš©ë˜ì§€ë§Œ, JSONì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ

##### ğŸ§© JSON ëŒ€ì‘ ë°©ë²•
- `@JsonFormat`(Jackson ì–´ë…¸í…Œì´ì…˜)
  - ë‚ ì§œëŠ” `@JsonFormat`ìœ¼ë¡œ ì²˜ë¦¬
- ì»¤ìŠ¤í…€ `Deserializer` ì‘ì„±
  - ìˆ«ìì— ì½¤ë§ˆê°€ í¬í•¨ëœ ê²½ìš°ëŠ” `Deserializer`ë¡œ ì²˜ë¦¬
